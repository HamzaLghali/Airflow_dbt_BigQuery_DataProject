[0m09:25:15.813867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd68e3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd691c2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd691f710>]}


============================== 09:25:15.816630 | 69e8dffe-339e-44f4-9666-5ec97e1410b5 ==============================
[0m09:25:15.816630 [info ] [MainThread]: Running with dbt=1.5.11
[0m09:25:15.821017 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80', 'use_colors': 'True', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'write_json': 'True', 'introspect': 'True', 'quiet': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'debug': 'False', 'warn_error': 'None'}
[0m09:25:15.936662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69e8dffe-339e-44f4-9666-5ec97e1410b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd68e3490>]}
[0m09:25:15.948861 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kdt88qgd'
[0m09:25:15.953770 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:25:16.159251 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:25:16.170555 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:25:16.357958 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:25:16.371442 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:25:20.031640 [info ] [MainThread]: Installed from version 1.1.1
[0m09:25:20.032852 [info ] [MainThread]: Up to date!
[0m09:25:20.034784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '69e8dffe-339e-44f4-9666-5ec97e1410b5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd68e3e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd68e3d50>]}
[0m09:25:20.036757 [debug] [MainThread]: Command `dbt deps` succeeded at 09:25:20.036538 after 4.26 seconds
[0m09:25:20.037760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd7b8ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd6c68890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd6c37b10>]}
[0m09:25:20.038698 [debug] [MainThread]: Flushing usage events
[0m09:26:31.321009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8507ad51d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85077c5710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850731f250>]}


============================== 09:26:31.323617 | ac9ac1a4-5802-4532-b58d-35bcdf5a6326 ==============================
[0m09:26:31.323617 [info ] [MainThread]: Running with dbt=1.5.11
[0m09:26:31.324944 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/include/dbt/', 'cache_selected_only': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'use_colors': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'debug': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'static_parser': 'True', 'quiet': 'False', 'write_json': 'True', 'warn_error': 'None'}
[0m09:26:32.164994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac9ac1a4-5802-4532-b58d-35bcdf5a6326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850552b710>]}
[0m09:26:32.185657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac9ac1a4-5802-4532-b58d-35bcdf5a6326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850552bdd0>]}
[0m09:26:32.187601 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m09:26:32.221452 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m09:26:32.227812 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:26:32.229289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ac9ac1a4-5802-4532-b58d-35bcdf5a6326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850555e690>]}
[0m09:26:32.270503 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading retail: sources/sources.yml - Runtime Error
    Syntax error near line 9
    ------------------------------
    6  | 
    7  |     tables:
    8  |       - name: raw_invoices
    9  | 			- name: country
    
    Raw Error:
    ------------------------------
    while scanning a plain scalar
      in "<unicode string>", line 8, column 15
    found a tab character that violates indentation
      in "<unicode string>", line 9, column 1
[0m09:26:32.272393 [debug] [MainThread]: Command `dbt run` failed at 09:26:32.272021 after 0.97 seconds
[0m09:26:32.273819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8507c8e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850731c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8507ac3b90>]}
[0m09:26:32.275384 [debug] [MainThread]: Flushing usage events
[0m09:26:54.637923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c53cf3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c53899010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c53b78750>]}


============================== 09:26:54.640297 | 5f231d12-a9d5-407e-879e-ff61e3704fa7 ==============================
[0m09:26:54.640297 [info ] [MainThread]: Running with dbt=1.5.11
[0m09:26:54.641588 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'no_print': 'None', 'quiet': 'False', 'fail_fast': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'static_parser': 'True'}
[0m09:26:55.254939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f231d12-a9d5-407e-879e-ff61e3704fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5156b910>]}
[0m09:26:55.274181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f231d12-a9d5-407e-879e-ff61e3704fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c51535f50>]}
[0m09:26:55.276384 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m09:26:55.316345 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m09:26:55.323942 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:26:55.325160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f231d12-a9d5-407e-879e-ff61e3704fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5157b390>]}
[0m09:26:57.119540 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail
[0m09:26:57.127450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f231d12-a9d5-407e-879e-ff61e3704fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5142d7d0>]}
[0m09:26:57.152606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f231d12-a9d5-407e-879e-ff61e3704fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c51578690>]}
[0m09:26:57.153790 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m09:26:57.155054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f231d12-a9d5-407e-879e-ff61e3704fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c56a47cd0>]}
[0m09:26:57.157122 [info ] [MainThread]: 
[0m09:26:57.158373 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:26:57.161707 [debug] [MainThread]: Command end result
[0m09:26:57.182974 [debug] [MainThread]: Command `dbt run` succeeded at 09:26:57.182665 after 2.57 seconds
[0m09:26:57.184396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c535397d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5792efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c515d6090>]}
[0m09:26:57.185388 [debug] [MainThread]: Flushing usage events
[0m09:27:29.020657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0488e15850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0489137050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0489127050>]}


============================== 09:27:29.023038 | d77d9a94-2132-454a-b930-4d0a80872292 ==============================
[0m09:27:29.023038 [info ] [MainThread]: Running with dbt=1.5.11
[0m09:27:29.024318 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_format': 'default', 'static_parser': 'True', 'partial_parse': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None'}
[0m09:27:29.582293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd77d9a94-2132-454a-b930-4d0a80872292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0486b9f790>]}
[0m09:27:29.604162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd77d9a94-2132-454a-b930-4d0a80872292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0486b94fd0>]}
[0m09:27:29.606103 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m09:27:29.640645 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m09:27:30.392533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m09:27:30.393617 [debug] [MainThread]: Partial parsing: added file: retail://models/transform/dim_customer.sql
[0m09:27:30.394509 [debug] [MainThread]: Partial parsing: added file: retail://models/transform/dim_product.sql
[0m09:27:30.395374 [debug] [MainThread]: Partial parsing: added file: retail://models/transform/fct_invoices.sql
[0m09:27:30.396190 [debug] [MainThread]: Partial parsing: added file: retail://models/transform/dim_datetime.sql
[0m09:27:30.427684 [debug] [MainThread]: 1603: static parser failed on transform/dim_customer.sql
[0m09:27:30.458292 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/dim_customer.sql
[0m09:27:30.461372 [debug] [MainThread]: 1603: static parser failed on transform/dim_product.sql
[0m09:27:30.469933 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/dim_product.sql
[0m09:27:30.473066 [debug] [MainThread]: 1603: static parser failed on transform/fct_invoices.sql
[0m09:27:30.485183 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/fct_invoices.sql
[0m09:27:30.491518 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m09:27:30.515821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd77d9a94-2132-454a-b930-4d0a80872292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0486bcbf50>]}
[0m09:27:30.537736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd77d9a94-2132-454a-b930-4d0a80872292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0485a29150>]}
[0m09:27:30.539045 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m09:27:30.540185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd77d9a94-2132-454a-b930-4d0a80872292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f048bf18110>]}
[0m09:27:30.543068 [info ] [MainThread]: 
[0m09:27:30.545159 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:27:30.547804 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-dbt-bigquery'
[0m09:27:30.548810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:27:32.264901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery, now list_airflow-dbt-bigquery_retail)
[0m09:27:32.269206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:27:33.587511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd77d9a94-2132-454a-b930-4d0a80872292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0486a792d0>]}
[0m09:27:33.589369 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:27:33.590803 [info ] [MainThread]: 
[0m09:27:33.606598 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m09:27:33.608613 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m09:27:33.611120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery_retail, now model.retail.dim_customer)
[0m09:27:33.612734 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m09:27:33.629195 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m09:27:33.650320 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 09:27:33.613844 => 09:27:33.649780
[0m09:27:33.652084 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m09:27:33.707379 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m09:27:33.731588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:27:33.738377 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_customer`
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as customer_id,
	    Country AS country
	FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-dbt-bigquery`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m09:27:38.090291 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:82500e4b-3c3d-46cd-89e9-86a07ebb2ba8&page=queryresults
[0m09:27:38.107916 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 09:27:33.653952 => 09:27:38.107663
[0m09:27:38.109754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd77d9a94-2132-454a-b930-4d0a80872292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0486bd1550>]}
[0m09:27:38.111088 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 4.50s]
[0m09:27:38.113098 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m09:27:38.114412 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m09:27:38.115517 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m09:27:38.117058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m09:27:38.118045 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m09:27:38.121771 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m09:27:38.128976 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 09:27:38.118757 => 09:27:38.128471
[0m09:27:38.130254 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m09:27:38.135141 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m09:27:38.146944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:27:38.151629 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

-- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m09:27:40.136430 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'; reason: invalidQuery, location: query, message: Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'")
[0m09:27:41.468902 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:8e1adb37-a6d9-41f1-a0be-2bd507650c09&page=queryresults
[0m09:27:41.473733 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 09:27:38.131129 => 09:27:41.472571
[0m09:27:41.489777 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m09:27:41.491927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd77d9a94-2132-454a-b930-4d0a80872292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0486aacfd0>]}
[0m09:27:41.493515 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 3.38s]
[0m09:27:41.494914 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m09:27:41.496292 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m09:27:41.497372 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m09:27:41.498971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m09:27:41.500024 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m09:27:41.507169 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m09:27:41.516182 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 09:27:41.500843 => 09:27:41.515780
[0m09:27:41.517384 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m09:27:41.521469 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m09:27:41.530734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:27:41.534941 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_product`
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m09:27:45.772163 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:52c44466-fc8e-450d-a66b-ede7317b7d8a&page=queryresults
[0m09:27:45.777955 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 09:27:41.518244 => 09:27:45.777714
[0m09:27:45.782478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd77d9a94-2132-454a-b930-4d0a80872292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0486b954d0>]}
[0m09:27:45.784294 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.28s]
[0m09:27:45.786079 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m09:27:45.788314 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m09:27:45.789450 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m09:27:45.791809 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m09:27:45.795813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:27:45.796946 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m09:27:45.797909 [info ] [MainThread]: 
[0m09:27:45.799012 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 15.25 seconds (15.25s).
[0m09:27:45.801035 [debug] [MainThread]: Command end result
[0m09:27:45.833944 [info ] [MainThread]: 
[0m09:27:45.835433 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:27:45.836812 [info ] [MainThread]: 
[0m09:27:45.838203 [error] [MainThread]: [33mDatabase Error in model dim_datetime (models/transform/dim_datetime.sql)[0m
[0m09:27:45.839676 [error] [MainThread]:   Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
[0m09:27:45.842165 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m09:27:45.845207 [info ] [MainThread]: 
[0m09:27:45.847381 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m09:27:45.849374 [debug] [MainThread]: Command `dbt run` failed at 09:27:45.849176 after 16.85 seconds
[0m09:27:45.850718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0488e82b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0489118150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f048bf18110>]}
[0m09:27:45.851741 [debug] [MainThread]: Flushing usage events
[0m09:30:46.141777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3d1ceb710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3d1ca3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3d5601390>]}


============================== 09:30:46.144436 | 5b44e41a-30f0-4f7b-8ba3-895fc23247d6 ==============================
[0m09:30:46.144436 [info ] [MainThread]: Running with dbt=1.5.11
[0m09:30:46.145927 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'debug': 'False', 'log_format': 'default', 'version_check': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80', 'target_path': 'None', 'quiet': 'False', 'use_colors': 'True', 'no_print': 'None', 'fail_fast': 'False', 'introspect': 'True'}
[0m09:30:46.662581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b44e41a-30f0-4f7b-8ba3-895fc23247d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3d01b7690>]}
[0m09:30:46.687311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b44e41a-30f0-4f7b-8ba3-895fc23247d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3d143e690>]}
[0m09:30:46.689213 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m09:30:46.738934 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m09:30:47.588387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:30:47.589298 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:30:47.595809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b44e41a-30f0-4f7b-8ba3-895fc23247d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3cf4b3510>]}
[0m09:30:47.615224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b44e41a-30f0-4f7b-8ba3-895fc23247d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3cf5e19d0>]}
[0m09:30:47.616313 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m09:30:47.617552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b44e41a-30f0-4f7b-8ba3-895fc23247d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3d4a5fbd0>]}
[0m09:30:47.620273 [info ] [MainThread]: 
[0m09:30:47.622355 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:30:47.624965 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-dbt-bigquery'
[0m09:30:47.626043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:30:48.475788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery, now list_airflow-dbt-bigquery_retail)
[0m09:30:48.478349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:30:49.276091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b44e41a-30f0-4f7b-8ba3-895fc23247d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3d2778750>]}
[0m09:30:49.283706 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:30:49.287100 [info ] [MainThread]: 
[0m09:30:49.295674 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m09:30:49.298017 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m09:30:49.300564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery_retail, now model.retail.dim_customer)
[0m09:30:49.302296 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m09:30:49.333619 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m09:30:49.346791 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 09:30:49.303470 => 09:30:49.346376
[0m09:30:49.347832 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m09:30:49.369284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:30:50.445585 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m09:30:50.455517 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_customer`
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as customer_id,
	    Country AS country
	FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-dbt-bigquery`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m09:30:54.185614 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:1b1be53c-11fd-4d9a-b420-01097aafa2d3&page=queryresults
[0m09:30:54.229477 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 09:30:49.348620 => 09:30:54.229205
[0m09:30:54.231070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b44e41a-30f0-4f7b-8ba3-895fc23247d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3cf5f88d0>]}
[0m09:30:54.232385 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 4.93s]
[0m09:30:54.234157 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m09:30:54.235902 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m09:30:54.237427 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m09:30:54.239396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m09:30:54.240669 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m09:30:54.245064 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m09:30:54.252072 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 09:30:54.241644 => 09:30:54.251692
[0m09:30:54.253518 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m09:30:54.257341 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m09:30:54.263440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:30:54.267337 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

-- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m09:30:56.542300 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'; reason: invalidQuery, location: query, message: Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'")
[0m09:30:58.816397 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:2956b3f4-64a0-449a-b88e-8a32c1c517a3&page=queryresults
[0m09:30:58.819219 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 09:30:54.254261 => 09:30:58.818812
[0m09:30:58.825624 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m09:30:58.826871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b44e41a-30f0-4f7b-8ba3-895fc23247d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3cf621110>]}
[0m09:30:58.828216 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 4.59s]
[0m09:30:58.829752 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m09:30:58.831103 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m09:30:58.832299 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m09:30:58.833858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m09:30:58.834904 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m09:30:58.844825 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m09:30:58.854704 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 09:30:58.835784 => 09:30:58.854302
[0m09:30:58.855696 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m09:30:58.859379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:30:59.718586 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m09:30:59.727110 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_product`
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m09:31:03.706957 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:d7a74a23-5131-4bef-be5b-30e6173ad7b7&page=queryresults
[0m09:31:03.710782 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 09:30:58.856482 => 09:31:03.710479
[0m09:31:03.712643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b44e41a-30f0-4f7b-8ba3-895fc23247d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3d22f7cd0>]}
[0m09:31:03.714246 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.88s]
[0m09:31:03.715813 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m09:31:03.717630 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m09:31:03.718603 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m09:31:03.719739 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m09:31:03.722366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:31:03.723148 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m09:31:03.723952 [info ] [MainThread]: 
[0m09:31:03.725074 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 16.10 seconds (16.10s).
[0m09:31:03.727118 [debug] [MainThread]: Command end result
[0m09:31:03.752767 [info ] [MainThread]: 
[0m09:31:03.754455 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:31:03.756236 [info ] [MainThread]: 
[0m09:31:03.757837 [error] [MainThread]: [33mDatabase Error in model dim_datetime (models/transform/dim_datetime.sql)[0m
[0m09:31:03.759162 [error] [MainThread]:   Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
[0m09:31:03.760831 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m09:31:03.762588 [info ] [MainThread]: 
[0m09:31:03.764855 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m09:31:03.767070 [debug] [MainThread]: Command `dbt run` failed at 09:31:03.766768 after 17.65 seconds
[0m09:31:03.768401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3d1ba4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3d1ba4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3d19d2050>]}
[0m09:31:03.769493 [debug] [MainThread]: Flushing usage events
[0m09:34:15.134752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be815b5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be788e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be7ef7610>]}


============================== 09:34:15.137193 | 471abe44-e092-4028-9229-51bae362b523 ==============================
[0m09:34:15.137193 [info ] [MainThread]: Running with dbt=1.5.11
[0m09:34:15.138819 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'log_format': 'default', 'no_print': 'None', 'debug': 'False', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'write_json': 'True', 'partial_parse': 'True'}
[0m09:34:15.610532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '471abe44-e092-4028-9229-51bae362b523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be8058cd0>]}
[0m09:34:15.628859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '471abe44-e092-4028-9229-51bae362b523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be78ac310>]}
[0m09:34:15.631395 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m09:34:15.668977 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m09:34:16.478911 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:34:16.479871 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:34:16.486327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '471abe44-e092-4028-9229-51bae362b523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be58bb350>]}
[0m09:34:16.505560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '471abe44-e092-4028-9229-51bae362b523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be5939710>]}
[0m09:34:16.506718 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m09:34:16.507883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '471abe44-e092-4028-9229-51bae362b523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5beadb7c90>]}
[0m09:34:16.510387 [info ] [MainThread]: 
[0m09:34:16.512372 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:34:16.514524 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-dbt-bigquery'
[0m09:34:16.515489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:34:17.558085 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery, now list_airflow-dbt-bigquery_retail)
[0m09:34:17.561663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:34:18.376550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '471abe44-e092-4028-9229-51bae362b523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be8ad0790>]}
[0m09:34:18.379556 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:34:18.380959 [info ] [MainThread]: 
[0m09:34:18.385832 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m09:34:18.387180 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m09:34:18.388734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery_retail, now model.retail.dim_customer)
[0m09:34:18.389710 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m09:34:18.415712 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m09:34:18.427643 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 09:34:18.390459 => 09:34:18.427186
[0m09:34:18.429039 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m09:34:18.452470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:19.337426 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m09:34:19.345603 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_customer`
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as customer_id,
	    Country AS country
	FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-dbt-bigquery`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m09:34:23.079674 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:8f5601d8-fe94-4b35-8f6a-5d44b8633de2&page=queryresults
[0m09:34:23.098122 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 09:34:18.430039 => 09:34:23.097878
[0m09:34:23.100052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '471abe44-e092-4028-9229-51bae362b523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be581e1d0>]}
[0m09:34:23.101657 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 4.71s]
[0m09:34:23.103635 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m09:34:23.105439 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m09:34:23.106660 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m09:34:23.108463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m09:34:23.109716 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m09:34:23.113728 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m09:34:23.121288 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 09:34:23.110526 => 09:34:23.120832
[0m09:34:23.122668 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m09:34:23.126520 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m09:34:23.134869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:23.139768 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

-- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m09:34:24.721199 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'; reason: invalidQuery, location: query, message: Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'")
[0m09:34:26.970692 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:cb4958fb-8634-4e20-8206-77e33e2998ad&page=queryresults
[0m09:34:26.973747 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 09:34:23.123379 => 09:34:26.973097
[0m09:34:26.981006 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m09:34:26.982507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '471abe44-e092-4028-9229-51bae362b523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be5798d10>]}
[0m09:34:26.983969 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 3.87s]
[0m09:34:26.985183 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m09:34:26.986369 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m09:34:26.987506 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m09:34:26.989003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m09:34:26.989908 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m09:34:26.998922 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m09:34:27.006715 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 09:34:26.990601 => 09:34:27.006347
[0m09:34:27.007929 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m09:34:27.011273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:27.802705 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m09:34:27.823130 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_product`
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m09:34:31.579675 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:5130a588-7d7b-4b10-abf7-241c9d756768&page=queryresults
[0m09:34:31.585108 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 09:34:27.008589 => 09:34:31.584866
[0m09:34:31.586483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '471abe44-e092-4028-9229-51bae362b523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be55e4590>]}
[0m09:34:31.587734 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.60s]
[0m09:34:31.589288 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m09:34:31.591210 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m09:34:31.592353 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m09:34:31.593604 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m09:34:31.596302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:34:31.597170 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m09:34:31.597965 [info ] [MainThread]: 
[0m09:34:31.598990 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 15.09 seconds (15.09s).
[0m09:34:31.601316 [debug] [MainThread]: Command end result
[0m09:34:31.628059 [info ] [MainThread]: 
[0m09:34:31.629570 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:34:31.630986 [info ] [MainThread]: 
[0m09:34:31.632704 [error] [MainThread]: [33mDatabase Error in model dim_datetime (models/transform/dim_datetime.sql)[0m
[0m09:34:31.634419 [error] [MainThread]:   Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
[0m09:34:31.636025 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m09:34:31.637631 [info ] [MainThread]: 
[0m09:34:31.639887 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m09:34:31.642128 [debug] [MainThread]: Command `dbt run` failed at 09:34:31.641791 after 16.53 seconds
[0m09:34:31.643662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be7ffa950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bebd45890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be7ef7410>]}
[0m09:34:31.645033 [debug] [MainThread]: Flushing usage events
[0m09:37:15.664133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7629adf910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76297c0510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7629c16490>]}


============================== 09:37:15.666540 | 0b9b9860-b039-476f-a95c-2335b41c1614 ==============================
[0m09:37:15.666540 [info ] [MainThread]: Running with dbt=1.5.11
[0m09:37:15.668320 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'introspect': 'True', 'use_colors': 'True', 'printer_width': '80', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'quiet': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'partial_parse': 'True', 'version_check': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs'}
[0m09:37:16.144423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b9b9860-b039-476f-a95c-2335b41c1614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76277fa250>]}
[0m09:37:16.164599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b9b9860-b039-476f-a95c-2335b41c1614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7627803ad0>]}
[0m09:37:16.166525 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m09:37:16.202999 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m09:37:17.059554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:37:17.060693 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m09:37:17.086953 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m09:37:17.119618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b9b9860-b039-476f-a95c-2335b41c1614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7627803e50>]}
[0m09:37:17.141975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b9b9860-b039-476f-a95c-2335b41c1614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76276f8910>]}
[0m09:37:17.143339 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m09:37:17.144688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b9b9860-b039-476f-a95c-2335b41c1614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f762cce3d10>]}
[0m09:37:17.147409 [info ] [MainThread]: 
[0m09:37:17.149604 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:37:17.152225 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-dbt-bigquery'
[0m09:37:17.153216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:37:17.980607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery, now list_airflow-dbt-bigquery_retail)
[0m09:37:17.981843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:37:18.726993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b9b9860-b039-476f-a95c-2335b41c1614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7629def250>]}
[0m09:37:18.728826 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:37:18.730073 [info ] [MainThread]: 
[0m09:37:18.734521 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m09:37:18.735642 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m09:37:18.737148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery_retail, now model.retail.dim_customer)
[0m09:37:18.738031 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m09:37:18.762204 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m09:37:18.769930 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 09:37:18.738775 => 09:37:18.769524
[0m09:37:18.771005 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m09:37:18.788188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:37:19.663314 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m09:37:19.675399 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_customer`
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as customer_id,
	    Country AS country
	FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-dbt-bigquery`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m09:37:23.405426 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:4944b400-ea41-433c-9b6a-09c41ca2cef2&page=queryresults
[0m09:37:23.431691 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 09:37:18.771748 => 09:37:23.431438
[0m09:37:23.433851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b9b9860-b039-476f-a95c-2335b41c1614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76277f2990>]}
[0m09:37:23.435296 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 4.70s]
[0m09:37:23.436890 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m09:37:23.438083 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m09:37:23.439187 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m09:37:23.440694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m09:37:23.441672 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m09:37:23.445947 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m09:37:23.454092 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 09:37:23.442522 => 09:37:23.453404
[0m09:37:23.455553 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m09:37:23.461010 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m09:37:23.472382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:37:23.479780 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

-- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        ERROR(FORMAT("Unexpected date format for InvoiceDate: '%s'", InvoiceDate))
    END AS date_part,
  FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m09:37:25.251327 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function is not implemented. id: cast_datetime_to_datetime; reason: invalidQuery, location: query, message: Function is not implemented. id: cast_datetime_to_datetime')
[0m09:37:27.104421 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:12d79da4-a645-4d44-8d44-e048d2d39388&page=queryresults
[0m09:37:27.107073 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 09:37:23.456628 => 09:37:27.106672
[0m09:37:27.113365 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Function is not implemented. id: cast_datetime_to_datetime
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m09:37:27.114657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b9b9860-b039-476f-a95c-2335b41c1614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76276bed50>]}
[0m09:37:27.116228 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 3.67s]
[0m09:37:27.117499 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m09:37:27.118810 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m09:37:27.119843 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m09:37:27.121358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m09:37:27.122260 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m09:37:27.129017 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m09:37:27.136647 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 09:37:27.123000 => 09:37:27.136106
[0m09:37:27.138078 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m09:37:27.141496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:37:27.909918 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m09:37:27.917554 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_product`
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m09:37:31.592994 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:6e69121c-cdf5-4561-a445-799d6fc65b6b&page=queryresults
[0m09:37:31.598091 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 09:37:27.138848 => 09:37:31.597822
[0m09:37:31.600068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b9b9860-b039-476f-a95c-2335b41c1614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f762783dd50>]}
[0m09:37:31.601555 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.48s]
[0m09:37:31.603239 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m09:37:31.605181 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m09:37:31.606181 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m09:37:31.607578 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m09:37:31.610439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:37:31.611244 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m09:37:31.612179 [info ] [MainThread]: 
[0m09:37:31.613636 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 14.46 seconds (14.46s).
[0m09:37:31.616003 [debug] [MainThread]: Command end result
[0m09:37:31.636383 [info ] [MainThread]: 
[0m09:37:31.638415 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:37:31.639998 [info ] [MainThread]: 
[0m09:37:31.641601 [error] [MainThread]: [33mDatabase Error in model dim_datetime (models/transform/dim_datetime.sql)[0m
[0m09:37:31.643079 [error] [MainThread]:   Function is not implemented. id: cast_datetime_to_datetime
[0m09:37:31.644657 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m09:37:31.646279 [info ] [MainThread]: 
[0m09:37:31.648205 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m09:37:31.650289 [debug] [MainThread]: Command `dbt run` failed at 09:37:31.650058 after 16.01 seconds
[0m09:37:31.651816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7629c6ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f762dc71990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76277570d0>]}
[0m09:37:31.653535 [debug] [MainThread]: Flushing usage events
[0m09:49:39.207551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7777c1e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777806af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7777f2aad0>]}


============================== 09:49:39.210538 | 5d67b647-73a3-45bb-9b9d-15a481c642ca ==============================
[0m09:49:39.210538 [info ] [MainThread]: Running with dbt=1.5.11
[0m09:49:39.212041 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_cache_events': 'False', 'use_colors': 'True', 'debug': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'target_path': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'partial_parse': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs'}
[0m09:49:39.242054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d67b647-73a3-45bb-9b9d-15a481c642ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77783d2e90>]}
[0m09:49:39.250398 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-eoi50o_o'
[0m09:49:39.252157 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:49:39.572676 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:49:39.578491 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:49:39.788521 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:49:39.799576 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:49:43.707184 [info ] [MainThread]: Installed from version 1.1.1
[0m09:49:43.709104 [info ] [MainThread]: Up to date!
[0m09:49:43.710873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5d67b647-73a3-45bb-9b9d-15a481c642ca', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77783c3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77783c0550>]}
[0m09:49:43.713529 [debug] [MainThread]: Command `dbt deps` succeeded at 09:49:43.713225 after 4.53 seconds
[0m09:49:43.714812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77780c8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777c00f090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777806aad0>]}
[0m09:49:43.716045 [debug] [MainThread]: Flushing usage events
[0m09:49:52.774923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f924737eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9247824ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9248c7bbd0>]}


============================== 09:49:52.777219 | 73c387af-ebed-40b7-a2b8-2f2d0e09929d ==============================
[0m09:49:52.777219 [info ] [MainThread]: Running with dbt=1.5.11
[0m09:49:52.778761 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'debug': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'partial_parse': 'True', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_format': 'default', 'indirect_selection': 'eager', 'version_check': 'True', 'introspect': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False'}
[0m09:49:53.238008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73c387af-ebed-40b7-a2b8-2f2d0e09929d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f924538acd0>]}
[0m09:49:53.258519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73c387af-ebed-40b7-a2b8-2f2d0e09929d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92453af750>]}
[0m09:49:53.260395 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m09:49:53.294704 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m09:49:54.070685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:49:54.071841 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m09:49:54.098334 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m09:49:54.130141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73c387af-ebed-40b7-a2b8-2f2d0e09929d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9247b136d0>]}
[0m09:49:54.152580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73c387af-ebed-40b7-a2b8-2f2d0e09929d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92451fac90>]}
[0m09:49:54.153688 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m09:49:54.155022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73c387af-ebed-40b7-a2b8-2f2d0e09929d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f924a89bc90>]}
[0m09:49:54.157612 [info ] [MainThread]: 
[0m09:49:54.159580 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:49:54.161920 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-dbt-bigquery'
[0m09:49:54.162921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:49:55.442166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery, now list_airflow-dbt-bigquery_retail)
[0m09:49:55.443785 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:49:56.255623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73c387af-ebed-40b7-a2b8-2f2d0e09929d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92485b4690>]}
[0m09:49:56.257759 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:49:56.259038 [info ] [MainThread]: 
[0m09:49:56.263953 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m09:49:56.265313 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m09:49:56.267044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery_retail, now model.retail.dim_customer)
[0m09:49:56.268373 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m09:49:56.295003 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m09:49:56.305506 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 09:49:56.269357 => 09:49:56.305140
[0m09:49:56.306613 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m09:49:56.323983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:57.213163 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m09:49:57.223042 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_customer`
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as customer_id,
	    Country AS country
	FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-dbt-bigquery`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m09:50:01.265025 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:524304ca-196c-4da6-93bc-218288933b1e&page=queryresults
[0m09:50:01.290368 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 09:49:56.307405 => 09:50:01.290099
[0m09:50:01.292000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73c387af-ebed-40b7-a2b8-2f2d0e09929d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92453f7750>]}
[0m09:50:01.293369 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 5.03s]
[0m09:50:01.294927 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m09:50:01.296277 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m09:50:01.297308 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m09:50:01.299029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m09:50:01.300604 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m09:50:01.305021 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m09:50:01.312255 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 09:50:01.301488 => 09:50:01.311862
[0m09:50:01.313236 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m09:50:01.318066 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m09:50:01.325835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:50:01.330655 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

-- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m09:50:03.114552 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'; reason: invalidQuery, location: query, message: Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'")
[0m09:50:05.279304 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:3606682d-94a0-488f-8982-c4004aee6318&page=queryresults
[0m09:50:05.286524 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 09:50:01.314109 => 09:50:05.285193
[0m09:50:05.304791 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m09:50:05.307305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73c387af-ebed-40b7-a2b8-2f2d0e09929d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f924521c490>]}
[0m09:50:05.309542 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 4.01s]
[0m09:50:05.312043 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m09:50:05.314336 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m09:50:05.316238 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m09:50:05.318481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m09:50:05.320597 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m09:50:05.328332 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m09:50:05.337240 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 09:50:05.322172 => 09:50:05.336774
[0m09:50:05.338514 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m09:50:05.341442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:50:06.596379 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m09:50:06.604745 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_product`
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m09:50:10.177557 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:30a897da-9c10-4ea3-9bb2-97793d804ead&page=queryresults
[0m09:50:10.190827 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 09:50:05.339226 => 09:50:10.189874
[0m09:50:10.196446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73c387af-ebed-40b7-a2b8-2f2d0e09929d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f924544e350>]}
[0m09:50:10.201193 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.88s]
[0m09:50:10.208253 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m09:50:10.213372 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m09:50:10.214740 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m09:50:10.216201 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m09:50:10.219091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:50:10.219882 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m09:50:10.220715 [info ] [MainThread]: 
[0m09:50:10.221751 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 16.06 seconds (16.06s).
[0m09:50:10.223585 [debug] [MainThread]: Command end result
[0m09:50:10.241298 [info ] [MainThread]: 
[0m09:50:10.242638 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:50:10.244000 [info ] [MainThread]: 
[0m09:50:10.245731 [error] [MainThread]: [33mDatabase Error in model dim_datetime (models/transform/dim_datetime.sql)[0m
[0m09:50:10.247457 [error] [MainThread]:   Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
[0m09:50:10.248787 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m09:50:10.250109 [info ] [MainThread]: 
[0m09:50:10.252267 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m09:50:10.254945 [debug] [MainThread]: Command `dbt run` failed at 09:50:10.254717 after 17.50 seconds
[0m09:50:10.256561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9248fd8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92477f7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9247696010>]}
[0m09:50:10.258233 [debug] [MainThread]: Flushing usage events
[0m09:57:30.021996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f143262b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1432927390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1433e5b450>]}


============================== 09:57:30.024438 | 1cf88101-5e66-4e14-8c0f-be0d167b3157 ==============================
[0m09:57:30.024438 [info ] [MainThread]: Running with dbt=1.5.11
[0m09:57:30.025734 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/include/dbt/', 'quiet': 'False', 'partial_parse': 'True', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'target_path': 'None', 'warn_error': 'None', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'log_format': 'default', 'static_parser': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'fail_fast': 'False'}
[0m09:57:30.507504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cf88101-5e66-4e14-8c0f-be0d167b3157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1431f50710>]}
[0m09:57:30.527703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cf88101-5e66-4e14-8c0f-be0d167b3157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f143009fb10>]}
[0m09:57:30.530007 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m09:57:30.565761 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m09:57:31.388993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:57:31.390174 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m09:57:31.417661 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m09:57:31.451278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cf88101-5e66-4e14-8c0f-be0d167b3157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f142fe6a5d0>]}
[0m09:57:31.474117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cf88101-5e66-4e14-8c0f-be0d167b3157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f142ffaaa50>]}
[0m09:57:31.475927 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m09:57:31.477984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cf88101-5e66-4e14-8c0f-be0d167b3157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f143557fd10>]}
[0m09:57:31.480718 [info ] [MainThread]: 
[0m09:57:31.483031 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:57:31.485944 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-dbt-bigquery'
[0m09:57:31.487480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:32.445872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery, now list_airflow-dbt-bigquery_retail)
[0m09:57:32.450150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:33.580180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cf88101-5e66-4e14-8c0f-be0d167b3157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14332985d0>]}
[0m09:57:33.582057 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:57:33.583253 [info ] [MainThread]: 
[0m09:57:33.592103 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m09:57:33.594215 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m09:57:33.596514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery_retail, now model.retail.dim_customer)
[0m09:57:33.598429 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m09:57:33.634456 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m09:57:33.650508 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 09:57:33.600307 => 09:57:33.650152
[0m09:57:33.653083 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m09:57:33.674829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:34.631554 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m09:57:34.641919 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_customer`
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as customer_id,
	    Country AS country
	FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-dbt-bigquery`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m09:57:38.377391 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:07001e8b-d528-4d64-a78d-e768d01954c5&page=queryresults
[0m09:57:38.403591 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 09:57:33.655114 => 09:57:38.403318
[0m09:57:38.405595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cf88101-5e66-4e14-8c0f-be0d167b3157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f142fffe550>]}
[0m09:57:38.407034 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 4.81s]
[0m09:57:38.408794 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m09:57:38.410172 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m09:57:38.411273 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m09:57:38.412759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m09:57:38.413772 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m09:57:38.417392 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m09:57:38.424546 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 09:57:38.414469 => 09:57:38.424083
[0m09:57:38.425716 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m09:57:38.430052 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m09:57:38.437669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:38.443025 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    -- Adding a CASE condition for debugging and format check
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) = 14 THEN
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        -- Handling unexpected formats by logging them
        ERROR(FORMAT("Unexpected date format for InvoiceDate: '%s'", InvoiceDate))
    END AS date_part
  FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m09:57:40.219344 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function is not implemented. id: cast_datetime_to_datetime; reason: invalidQuery, location: query, message: Function is not implemented. id: cast_datetime_to_datetime')
[0m09:57:41.982458 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:eef90e54-e450-42c4-b1cf-36cdcb8d3389&page=queryresults
[0m09:57:41.988727 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 09:57:38.426589 => 09:57:41.987332
[0m09:57:41.996924 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Function is not implemented. id: cast_datetime_to_datetime
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m09:57:41.998460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cf88101-5e66-4e14-8c0f-be0d167b3157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f142ffe03d0>]}
[0m09:57:41.999842 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 3.59s]
[0m09:57:42.001154 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m09:57:42.002181 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m09:57:42.003279 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m09:57:42.004772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m09:57:42.005732 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m09:57:42.012190 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m09:57:42.019200 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 09:57:42.006502 => 09:57:42.018623
[0m09:57:42.020580 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m09:57:42.024205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:42.979861 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m09:57:42.990119 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_product`
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m09:57:46.771932 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:624ca19a-f91e-4346-bc30-b4f88146aa61&page=queryresults
[0m09:57:46.776346 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 09:57:42.021566 => 09:57:46.776012
[0m09:57:46.777964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cf88101-5e66-4e14-8c0f-be0d167b3157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f142ff58c10>]}
[0m09:57:46.779562 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.77s]
[0m09:57:46.781315 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m09:57:46.783162 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m09:57:46.784220 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m09:57:46.785400 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m09:57:46.787936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:46.788629 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m09:57:46.789429 [info ] [MainThread]: 
[0m09:57:46.790434 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 15.31 seconds (15.31s).
[0m09:57:46.792170 [debug] [MainThread]: Command end result
[0m09:57:46.811379 [info ] [MainThread]: 
[0m09:57:46.812929 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:57:46.814405 [info ] [MainThread]: 
[0m09:57:46.815886 [error] [MainThread]: [33mDatabase Error in model dim_datetime (models/transform/dim_datetime.sql)[0m
[0m09:57:46.817312 [error] [MainThread]:   Function is not implemented. id: cast_datetime_to_datetime
[0m09:57:46.818791 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m09:57:46.820549 [info ] [MainThread]: 
[0m09:57:46.822271 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m09:57:46.824673 [debug] [MainThread]: Command `dbt run` failed at 09:57:46.824391 after 16.83 seconds
[0m09:57:46.825834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f143262b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1432371110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f142edc9a50>]}
[0m09:57:46.827147 [debug] [MainThread]: Flushing usage events
[0m09:59:13.456109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1ba22b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1ba22a950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1ba228d10>]}


============================== 09:59:13.458376 | 3c4de2cf-be9d-4b87-be21-fe6a13c9dda1 ==============================
[0m09:59:13.458376 [info ] [MainThread]: Running with dbt=1.5.11
[0m09:59:13.459683 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'write_json': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'printer_width': '80', 'introspect': 'True', 'quiet': 'False', 'no_print': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'fail_fast': 'False'}
[0m09:59:13.949001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c4de2cf-be9d-4b87-be21-fe6a13c9dda1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1b7a6a310>]}
[0m09:59:13.967068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c4de2cf-be9d-4b87-be21-fe6a13c9dda1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1b9f01250>]}
[0m09:59:13.968601 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m09:59:14.006990 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m09:59:14.801518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:59:14.802960 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m09:59:14.832202 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m09:59:14.867208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c4de2cf-be9d-4b87-be21-fe6a13c9dda1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1b7a58ed0>]}
[0m09:59:14.888965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c4de2cf-be9d-4b87-be21-fe6a13c9dda1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1b795b390>]}
[0m09:59:14.890364 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m09:59:14.891747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c4de2cf-be9d-4b87-be21-fe6a13c9dda1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1bcd5c0d0>]}
[0m09:59:14.894299 [info ] [MainThread]: 
[0m09:59:14.896261 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:59:14.899300 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-dbt-bigquery'
[0m09:59:14.900436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:15.868063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery, now list_airflow-dbt-bigquery_retail)
[0m09:59:15.869702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:16.684680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c4de2cf-be9d-4b87-be21-fe6a13c9dda1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1b7b3f090>]}
[0m09:59:16.687166 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:59:16.688209 [info ] [MainThread]: 
[0m09:59:16.692479 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m09:59:16.693857 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m09:59:16.695542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery_retail, now model.retail.dim_customer)
[0m09:59:16.696676 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m09:59:16.724900 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m09:59:16.733767 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 09:59:16.697663 => 09:59:16.733309
[0m09:59:16.734879 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m09:59:16.753467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:17.733802 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m09:59:17.745328 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_customer`
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as customer_id,
	    Country AS country
	FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-dbt-bigquery`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m09:59:21.914879 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:a3a0914c-e692-4b77-87d1-5b2784fb6aab&page=queryresults
[0m09:59:21.944159 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 09:59:16.735813 => 09:59:21.943902
[0m09:59:21.946208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c4de2cf-be9d-4b87-be21-fe6a13c9dda1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1b79a6f90>]}
[0m09:59:21.948064 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 5.25s]
[0m09:59:21.949785 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m09:59:21.951506 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m09:59:21.952558 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m09:59:21.954124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m09:59:21.955252 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m09:59:21.959474 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m09:59:21.968392 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 09:59:21.956213 => 09:59:21.967934
[0m09:59:21.969638 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m09:59:21.974368 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m09:59:21.981671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:21.987394 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

-- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m09:59:25.094077 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'; reason: invalidQuery, location: query, message: Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'")
[0m09:59:27.237876 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:7060a14f-8e4d-479e-8362-bed605cf6b9e&page=queryresults
[0m09:59:27.239885 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 09:59:21.970565 => 09:59:27.239484
[0m09:59:27.245526 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m09:59:27.246834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c4de2cf-be9d-4b87-be21-fe6a13c9dda1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1b689f810>]}
[0m09:59:27.248234 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 5.29s]
[0m09:59:27.249472 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m09:59:27.250756 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m09:59:27.251917 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m09:59:27.253666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m09:59:27.254813 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m09:59:27.261147 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m09:59:27.267909 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 09:59:27.255618 => 09:59:27.267453
[0m09:59:27.269764 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m09:59:27.273562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:28.564411 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m09:59:28.574381 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_product`
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m09:59:32.247152 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:776c7fa7-34d1-40da-bfb1-518887a55022&page=queryresults
[0m09:59:32.258553 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 09:59:27.270889 => 09:59:32.257740
[0m09:59:32.264033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c4de2cf-be9d-4b87-be21-fe6a13c9dda1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1b68b4610>]}
[0m09:59:32.268846 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 5.01s]
[0m09:59:32.274798 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m09:59:32.281156 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m09:59:32.284271 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m09:59:32.288157 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m09:59:32.291662 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:59:32.292638 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m09:59:32.293533 [info ] [MainThread]: 
[0m09:59:32.294800 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 17.40 seconds (17.40s).
[0m09:59:32.297264 [debug] [MainThread]: Command end result
[0m09:59:32.319224 [info ] [MainThread]: 
[0m09:59:32.321264 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:59:32.323124 [info ] [MainThread]: 
[0m09:59:32.324866 [error] [MainThread]: [33mDatabase Error in model dim_datetime (models/transform/dim_datetime.sql)[0m
[0m09:59:32.326659 [error] [MainThread]:   Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
[0m09:59:32.328680 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m09:59:32.330791 [info ] [MainThread]: 
[0m09:59:32.332294 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m09:59:32.333915 [debug] [MainThread]: Command `dbt run` failed at 09:59:32.333730 after 18.90 seconds
[0m09:59:32.334944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1ba09bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1b9a74b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1b7995090>]}
[0m09:59:32.335905 [debug] [MainThread]: Flushing usage events
[0m10:02:02.700408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff95fb4fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff95fe98050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff95ffb89d0>]}


============================== 10:02:02.703290 | f39fd30b-fc38-489f-b4ba-50b4fe02646d ==============================
[0m10:02:02.703290 [info ] [MainThread]: Running with dbt=1.5.11
[0m10:02:02.704809 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'quiet': 'False', 'partial_parse': 'True', 'no_print': 'None', 'printer_width': '80', 'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'debug': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/'}
[0m10:02:03.177968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f39fd30b-fc38-489f-b4ba-50b4fe02646d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff95d8a6cd0>]}
[0m10:02:03.196597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f39fd30b-fc38-489f-b4ba-50b4fe02646d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff95fe88450>]}
[0m10:02:03.198387 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m10:02:03.232502 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m10:02:03.988018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:02:03.988904 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:02:03.995501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f39fd30b-fc38-489f-b4ba-50b4fe02646d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff95fe656d0>]}
[0m10:02:04.015344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f39fd30b-fc38-489f-b4ba-50b4fe02646d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff95d729850>]}
[0m10:02:04.016634 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m10:02:04.017970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f39fd30b-fc38-489f-b4ba-50b4fe02646d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9629bc0d0>]}
[0m10:02:04.020799 [info ] [MainThread]: 
[0m10:02:04.022905 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:02:04.025404 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-dbt-bigquery'
[0m10:02:04.026576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:02:04.832194 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery, now list_airflow-dbt-bigquery_retail)
[0m10:02:04.835738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:02:05.749453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f39fd30b-fc38-489f-b4ba-50b4fe02646d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff960908650>]}
[0m10:02:05.756926 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:02:05.761672 [info ] [MainThread]: 
[0m10:02:05.772971 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m10:02:05.775182 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m10:02:05.777308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery_retail, now model.retail.dim_customer)
[0m10:02:05.779185 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m10:02:05.805944 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m10:02:05.817899 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 10:02:05.780771 => 10:02:05.817520
[0m10:02:05.818874 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m10:02:05.840701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:02:06.735284 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m10:02:06.746962 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_customer`
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as customer_id,
	    Country AS country
	FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-dbt-bigquery`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m10:02:10.450519 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:05e6f8ff-7f9a-4997-978f-c0637fa803d0&page=queryresults
[0m10:02:10.473706 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 10:02:05.819639 => 10:02:10.473344
[0m10:02:10.475600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f39fd30b-fc38-489f-b4ba-50b4fe02646d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff95d75bdd0>]}
[0m10:02:10.477180 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 4.70s]
[0m10:02:10.479370 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m10:02:10.481560 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m10:02:10.482960 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m10:02:10.485168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m10:02:10.486398 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m10:02:10.490416 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m10:02:10.498581 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 10:02:10.487215 => 10:02:10.498137
[0m10:02:10.500223 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m10:02:10.505553 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m10:02:10.513135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:02:10.518011 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

-- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m10:02:12.520221 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'; reason: invalidQuery, location: query, message: Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'")
[0m10:02:14.855557 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:bf5430b8-0838-4cdf-bf93-e0d97731e29c&page=queryresults
[0m10:02:14.858081 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 10:02:10.501389 => 10:02:14.857688
[0m10:02:14.864478 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m10:02:14.865669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f39fd30b-fc38-489f-b4ba-50b4fe02646d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff95d75add0>]}
[0m10:02:14.867054 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 4.38s]
[0m10:02:14.868880 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m10:02:14.870317 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m10:02:14.871933 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m10:02:14.874229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m10:02:14.875742 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m10:02:14.886162 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m10:02:14.894660 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 10:02:14.876865 => 10:02:14.894225
[0m10:02:14.895736 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m10:02:14.898958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:02:15.675605 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m10:02:15.687596 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_product`
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m10:02:19.672972 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:772c31af-eda2-4084-999e-89807d44803b&page=queryresults
[0m10:02:19.678304 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 10:02:14.896530 => 10:02:19.677980
[0m10:02:19.680781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f39fd30b-fc38-489f-b4ba-50b4fe02646d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff95d8a7ed0>]}
[0m10:02:19.682930 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.81s]
[0m10:02:19.685142 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m10:02:19.687336 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m10:02:19.688664 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m10:02:19.689990 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m10:02:19.693195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:02:19.694198 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m10:02:19.695338 [info ] [MainThread]: 
[0m10:02:19.697007 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 15.67 seconds (15.67s).
[0m10:02:19.699895 [debug] [MainThread]: Command end result
[0m10:02:19.724131 [info ] [MainThread]: 
[0m10:02:19.725508 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:02:19.726799 [info ] [MainThread]: 
[0m10:02:19.728305 [error] [MainThread]: [33mDatabase Error in model dim_datetime (models/transform/dim_datetime.sql)[0m
[0m10:02:19.730537 [error] [MainThread]:   Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
[0m10:02:19.732333 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m10:02:19.733892 [info ] [MainThread]: 
[0m10:02:19.735700 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m10:02:19.737664 [debug] [MainThread]: Command `dbt run` failed at 10:02:19.737488 after 17.06 seconds
[0m10:02:19.739043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff961322a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff95f9bf890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff95fe65490>]}
[0m10:02:19.740119 [debug] [MainThread]: Flushing usage events
[0m10:08:25.448524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda327de550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda32caa310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda327b65d0>]}


============================== 10:08:25.452599 | e4c0f92b-e0d9-4891-a98f-06be957d0a3d ==============================
[0m10:08:25.452599 [info ] [MainThread]: Running with dbt=1.5.11
[0m10:08:25.454193 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'fail_fast': 'False', 'quiet': 'False', 'log_format': 'default', 'no_print': 'None', 'partial_parse': 'True', 'write_json': 'True', 'target_path': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'static_parser': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'use_colors': 'True'}
[0m10:08:26.032001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4c0f92b-e0d9-4891-a98f-06be957d0a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda3054b790>]}
[0m10:08:26.053415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4c0f92b-e0d9-4891-a98f-06be957d0a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda30516850>]}
[0m10:08:26.055135 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m10:08:26.089606 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m10:08:26.901686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:08:26.902918 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m10:08:26.930420 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m10:08:26.965050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4c0f92b-e0d9-4891-a98f-06be957d0a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda305780d0>]}
[0m10:08:26.987315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4c0f92b-e0d9-4891-a98f-06be957d0a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda303aacd0>]}
[0m10:08:26.988533 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m10:08:26.989953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4c0f92b-e0d9-4891-a98f-06be957d0a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda303d7a90>]}
[0m10:08:26.992769 [info ] [MainThread]: 
[0m10:08:26.994755 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:08:26.997293 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-dbt-bigquery'
[0m10:08:26.998546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:08:28.524284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery, now list_airflow-dbt-bigquery_retail)
[0m10:08:28.526831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:08:29.639779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4c0f92b-e0d9-4891-a98f-06be957d0a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda335a0710>]}
[0m10:08:29.643132 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:08:29.644336 [info ] [MainThread]: 
[0m10:08:29.648873 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m10:08:29.650105 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m10:08:29.651713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery_retail, now model.retail.dim_customer)
[0m10:08:29.652755 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m10:08:29.674599 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m10:08:29.686445 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 10:08:29.653595 => 10:08:29.685874
[0m10:08:29.687915 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m10:08:29.705108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:08:30.694720 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m10:08:30.705444 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_customer`
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as customer_id,
	    Country AS country
	FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-dbt-bigquery`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m10:08:34.553900 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:797c0430-148b-40b3-a986-f99315b6bb9b&page=queryresults
[0m10:08:34.589915 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 10:08:29.689029 => 10:08:34.589656
[0m10:08:34.592068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4c0f92b-e0d9-4891-a98f-06be957d0a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda30438650>]}
[0m10:08:34.593876 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 4.94s]
[0m10:08:34.595748 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m10:08:34.597303 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m10:08:34.598524 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m10:08:34.600057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m10:08:34.601018 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m10:08:34.605116 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m10:08:34.612243 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 10:08:34.601754 => 10:08:34.611597
[0m10:08:34.613299 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m10:08:34.617310 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m10:08:34.623982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:08:34.628326 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

-- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %k:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m10:08:36.920578 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'; reason: invalidQuery, location: query, message: Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'")
[0m10:08:38.969271 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:849cf70b-f8c6-4cba-9b94-68179a1f77b9&page=queryresults
[0m10:08:38.975693 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 10:08:34.614118 => 10:08:38.974315
[0m10:08:38.994325 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m10:08:38.997498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4c0f92b-e0d9-4891-a98f-06be957d0a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda30402350>]}
[0m10:08:39.002906 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 4.40s]
[0m10:08:39.006134 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m10:08:39.008700 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m10:08:39.011206 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m10:08:39.014260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m10:08:39.016662 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m10:08:39.025868 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m10:08:39.036898 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 10:08:39.018585 => 10:08:39.036479
[0m10:08:39.038002 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m10:08:39.041211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:08:40.505427 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m10:08:40.543239 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_product`
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m10:08:43.986643 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:33daaeb3-65fb-43d6-b81b-f56f8fafd8be&page=queryresults
[0m10:08:44.000754 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 10:08:39.038868 => 10:08:43.999646
[0m10:08:44.006615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4c0f92b-e0d9-4891-a98f-06be957d0a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda2f1ab810>]}
[0m10:08:44.011410 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.99s]
[0m10:08:44.015848 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m10:08:44.020842 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m10:08:44.022411 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m10:08:44.023933 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m10:08:44.027600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:08:44.028525 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m10:08:44.029529 [info ] [MainThread]: 
[0m10:08:44.030708 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 17.04 seconds (17.04s).
[0m10:08:44.033005 [debug] [MainThread]: Command end result
[0m10:08:44.054790 [info ] [MainThread]: 
[0m10:08:44.056578 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:08:44.058768 [info ] [MainThread]: 
[0m10:08:44.060701 [error] [MainThread]: [33mDatabase Error in model dim_datetime (models/transform/dim_datetime.sql)[0m
[0m10:08:44.062243 [error] [MainThread]:   Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
[0m10:08:44.064185 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m10:08:44.066001 [info ] [MainThread]: 
[0m10:08:44.068098 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m10:08:44.069932 [debug] [MainThread]: Command `dbt run` failed at 10:08:44.069729 after 18.66 seconds
[0m10:08:44.071432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda32b02fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda327df050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda32ae6050>]}
[0m10:08:44.073178 [debug] [MainThread]: Flushing usage events
[0m10:09:45.375283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c3ad35910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c3b037310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c3b0280d0>]}


============================== 10:09:45.407705 | 1f62c19b-4a08-4be6-a7bc-329a4c32fded ==============================
[0m10:09:45.407705 [info ] [MainThread]: Running with dbt=1.5.11
[0m10:09:45.409643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'debug': 'False', 'quiet': 'False', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_cache_events': 'False', 'target_path': 'None'}
[0m10:09:45.958114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f62c19b-4a08-4be6-a7bc-329a4c32fded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c388d4890>]}
[0m10:09:45.975428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f62c19b-4a08-4be6-a7bc-329a4c32fded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c388dadd0>]}
[0m10:09:45.976991 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m10:09:46.011569 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m10:09:46.802979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:09:46.804168 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m10:09:46.830207 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m10:09:46.863410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f62c19b-4a08-4be6-a7bc-329a4c32fded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c38a618d0>]}
[0m10:09:46.885131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f62c19b-4a08-4be6-a7bc-329a4c32fded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c3871ecd0>]}
[0m10:09:46.886347 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m10:09:46.887725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f62c19b-4a08-4be6-a7bc-329a4c32fded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c3db98090>]}
[0m10:09:46.890387 [info ] [MainThread]: 
[0m10:09:46.892390 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:09:46.895728 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-dbt-bigquery'
[0m10:09:46.897134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:09:47.878180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery, now list_airflow-dbt-bigquery_retail)
[0m10:09:47.880700 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:09:48.708928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f62c19b-4a08-4be6-a7bc-329a4c32fded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c3bad84d0>]}
[0m10:09:48.714626 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:09:48.718620 [info ] [MainThread]: 
[0m10:09:48.726874 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m10:09:48.728171 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m10:09:48.729802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery_retail, now model.retail.dim_customer)
[0m10:09:48.731008 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m10:09:48.756099 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m10:09:48.767636 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 10:09:48.731972 => 10:09:48.767078
[0m10:09:48.769094 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m10:09:48.786833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:09:49.744357 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m10:09:49.754693 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_customer`
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as customer_id,
	    Country AS country
	FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-dbt-bigquery`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m10:09:53.606543 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:6f5eba11-066b-4d9b-a128-7eab1fe03ef0&page=queryresults
[0m10:09:53.660133 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 10:09:48.770300 => 10:09:53.659788
[0m10:09:53.662804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f62c19b-4a08-4be6-a7bc-329a4c32fded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c388f7f50>]}
[0m10:09:53.665045 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 4.93s]
[0m10:09:53.667441 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m10:09:53.669416 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m10:09:53.670827 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m10:09:53.672396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m10:09:53.673313 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m10:09:53.677020 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m10:09:53.684027 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 10:09:53.674035 => 10:09:53.683442
[0m10:09:53.685201 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m10:09:53.689341 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m10:09:53.697638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:09:53.703387 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

-- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%e/%Y %k:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m10:09:55.855000 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'; reason: invalidQuery, location: query, message: Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'")
[0m10:09:57.919044 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:a7584b46-cca7-4cd8-a0a7-baad89342927&page=queryresults
[0m10:09:57.925758 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 10:09:53.685985 => 10:09:57.924576
[0m10:09:57.942345 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m10:09:57.944909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f62c19b-4a08-4be6-a7bc-329a4c32fded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c387a5650>]}
[0m10:09:57.947482 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 4.27s]
[0m10:09:57.949486 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m10:09:57.951999 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m10:09:57.954119 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m10:09:57.956448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m10:09:57.957888 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m10:09:57.964583 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m10:09:57.974151 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 10:09:57.958784 => 10:09:57.973746
[0m10:09:57.975312 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m10:09:57.978378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:09:58.828890 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m10:09:58.840086 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_product`
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m10:10:02.519326 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:c19760a6-9bbb-423d-a837-18efb87bd7e5&page=queryresults
[0m10:10:02.528060 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 10:09:57.976051 => 10:10:02.527788
[0m10:10:02.529613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f62c19b-4a08-4be6-a7bc-329a4c32fded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c3880ba90>]}
[0m10:10:02.531066 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.57s]
[0m10:10:02.532859 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m10:10:02.534898 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m10:10:02.535793 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m10:10:02.537028 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m10:10:02.540041 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:10:02.540985 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m10:10:02.542209 [info ] [MainThread]: 
[0m10:10:02.543907 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 15.65 seconds (15.65s).
[0m10:10:02.546193 [debug] [MainThread]: Command end result
[0m10:10:02.566566 [info ] [MainThread]: 
[0m10:10:02.568136 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:10:02.570184 [info ] [MainThread]: 
[0m10:10:02.572076 [error] [MainThread]: [33mDatabase Error in model dim_datetime (models/transform/dim_datetime.sql)[0m
[0m10:10:02.573507 [error] [MainThread]:   Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
[0m10:10:02.575414 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m10:10:02.577231 [info ] [MainThread]: 
[0m10:10:02.579068 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m10:10:02.581571 [debug] [MainThread]: Command `dbt run` failed at 10:10:02.581359 after 17.23 seconds
[0m10:10:02.582781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c3abb6590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c3ad4be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c3ed3d7d0>]}
[0m10:10:02.583590 [debug] [MainThread]: Flushing usage events
[0m10:12:21.999268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375334f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375382bbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37536f4d50>]}


============================== 10:12:22.001736 | 0c2a584d-b289-4f74-8598-ceac17102944 ==============================
[0m10:12:22.001736 [info ] [MainThread]: Running with dbt=1.5.11
[0m10:12:22.003176 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'version_check': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'log_format': 'default', 'warn_error': 'None', 'use_experimental_parser': 'False', 'quiet': 'False'}
[0m10:12:22.507288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c2a584d-b289-4f74-8598-ceac17102944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3753362dd0>]}
[0m10:12:22.527422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c2a584d-b289-4f74-8598-ceac17102944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3753362dd0>]}
[0m10:12:22.529390 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m10:12:22.567907 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m10:12:23.340981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:12:23.342318 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m10:12:23.371985 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m10:12:23.408269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c2a584d-b289-4f74-8598-ceac17102944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3750f82590>]}
[0m10:12:23.433539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c2a584d-b289-4f74-8598-ceac17102944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3750fe0490>]}
[0m10:12:23.435242 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m10:12:23.436787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c2a584d-b289-4f74-8598-ceac17102944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3756464110>]}
[0m10:12:23.440024 [info ] [MainThread]: 
[0m10:12:23.442361 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:12:23.445104 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-dbt-bigquery'
[0m10:12:23.446509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:12:24.561939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery, now list_airflow-dbt-bigquery_retail)
[0m10:12:24.563491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:12:26.491488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c2a584d-b289-4f74-8598-ceac17102944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3754120950>]}
[0m10:12:26.494128 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:12:26.495369 [info ] [MainThread]: 
[0m10:12:26.499976 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m10:12:26.501198 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m10:12:26.502556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery_retail, now model.retail.dim_customer)
[0m10:12:26.503673 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m10:12:26.528353 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m10:12:26.537691 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 10:12:26.504501 => 10:12:26.537266
[0m10:12:26.538597 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m10:12:26.554655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:12:27.843027 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m10:12:27.852423 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_customer`
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as customer_id,
	    Country AS country
	FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-dbt-bigquery`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m10:12:32.220032 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:ce5dbf4a-eaec-4178-9a81-36cce38e6b82&page=queryresults
[0m10:12:32.259743 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 10:12:26.539289 => 10:12:32.259441
[0m10:12:32.261974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c2a584d-b289-4f74-8598-ceac17102944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3751075910>]}
[0m10:12:32.263843 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 5.76s]
[0m10:12:32.265809 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m10:12:32.267329 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m10:12:32.268543 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m10:12:32.270206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m10:12:32.271203 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m10:12:32.275126 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m10:12:32.282866 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 10:12:32.271980 => 10:12:32.282414
[0m10:12:32.284550 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m10:12:32.289029 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m10:12:32.296906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:12:32.301232 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

-- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%e/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m10:12:34.474413 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'; reason: invalidQuery, location: query, message: Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'")
[0m10:12:36.213874 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:bae280e2-9f0e-4849-a273-5adc526eaa67&page=queryresults
[0m10:12:36.215697 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 10:12:32.285675 => 10:12:36.215254
[0m10:12:36.221037 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m10:12:36.222604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c2a584d-b289-4f74-8598-ceac17102944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3750f98390>]}
[0m10:12:36.224343 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 3.95s]
[0m10:12:36.226585 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m10:12:36.228654 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m10:12:36.230196 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m10:12:36.232690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m10:12:36.234002 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m10:12:36.240650 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m10:12:36.248724 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 10:12:36.234861 => 10:12:36.248263
[0m10:12:36.250015 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m10:12:36.253453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:12:37.032878 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m10:12:37.043744 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_product`
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m10:12:41.440527 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:d55a588d-8b4e-4dda-bbb4-bad7512dcf14&page=queryresults
[0m10:12:41.452889 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 10:12:36.251066 => 10:12:41.451784
[0m10:12:41.458361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c2a584d-b289-4f74-8598-ceac17102944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f373bd01f50>]}
[0m10:12:41.463153 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 5.23s]
[0m10:12:41.469522 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m10:12:41.475338 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m10:12:41.478491 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m10:12:41.480063 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m10:12:41.483611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:12:41.484983 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m10:12:41.486285 [info ] [MainThread]: 
[0m10:12:41.487802 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 18.04 seconds (18.04s).
[0m10:12:41.490359 [debug] [MainThread]: Command end result
[0m10:12:41.516251 [info ] [MainThread]: 
[0m10:12:41.518160 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:12:41.519999 [info ] [MainThread]: 
[0m10:12:41.521891 [error] [MainThread]: [33mDatabase Error in model dim_datetime (models/transform/dim_datetime.sql)[0m
[0m10:12:41.523389 [error] [MainThread]:   Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
[0m10:12:41.525038 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m10:12:41.526620 [info ] [MainThread]: 
[0m10:12:41.528211 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m10:12:41.530215 [debug] [MainThread]: Command `dbt run` failed at 10:12:41.529993 after 19.56 seconds
[0m10:12:41.531379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375382b390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37533c9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3757265590>]}
[0m10:12:41.532971 [debug] [MainThread]: Flushing usage events
[0m10:24:20.320126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40db0bad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40db0dcad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40daf4dc50>]}


============================== 10:24:20.322290 | 97b43eb9-d043-49d3-ab48-ec02fbebe852 ==============================
[0m10:24:20.322290 [info ] [MainThread]: Running with dbt=1.5.11
[0m10:24:20.323646 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'partial_parse': 'True', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_format': 'default', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'printer_width': '80', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True'}
[0m10:24:20.803788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97b43eb9-d043-49d3-ab48-ec02fbebe852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40d893ac10>]}
[0m10:24:20.823831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97b43eb9-d043-49d3-ab48-ec02fbebe852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40d893b0d0>]}
[0m10:24:20.825448 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m10:24:20.859575 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m10:24:21.548787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:24:21.549911 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m10:24:21.577871 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m10:24:21.612367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97b43eb9-d043-49d3-ab48-ec02fbebe852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40d894cfd0>]}
[0m10:24:21.635109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97b43eb9-d043-49d3-ab48-ec02fbebe852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40d879ac90>]}
[0m10:24:21.636769 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m10:24:21.638449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97b43eb9-d043-49d3-ab48-ec02fbebe852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40dde37c90>]}
[0m10:24:21.641865 [info ] [MainThread]: 
[0m10:24:21.643908 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:24:21.646355 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-dbt-bigquery'
[0m10:24:21.647427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:22.891979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery, now list_airflow-dbt-bigquery_retail)
[0m10:24:22.893227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:23.908824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97b43eb9-d043-49d3-ab48-ec02fbebe852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40dbb5c550>]}
[0m10:24:23.910376 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:24:23.911578 [info ] [MainThread]: 
[0m10:24:23.915724 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m10:24:23.916925 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m10:24:23.918550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery_retail, now model.retail.dim_customer)
[0m10:24:23.919610 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m10:24:23.943212 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m10:24:23.954742 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 10:24:23.920326 => 10:24:23.954094
[0m10:24:23.956268 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m10:24:23.973716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:25.164667 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m10:24:25.174920 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_customer`
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as customer_id,
	    Country AS country
	FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-dbt-bigquery`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m10:24:29.332558 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:68fbfc9f-3ff3-48ca-8a06-4673920ff548&page=queryresults
[0m10:24:29.369482 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 10:24:23.957245 => 10:24:29.369225
[0m10:24:29.371585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b43eb9-d043-49d3-ab48-ec02fbebe852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40d8828250>]}
[0m10:24:29.373291 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 5.45s]
[0m10:24:29.375358 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m10:24:29.377032 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m10:24:29.378225 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m10:24:29.379749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m10:24:29.380769 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m10:24:29.384574 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m10:24:29.391915 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 10:24:29.381512 => 10:24:29.391445
[0m10:24:29.393012 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m10:24:29.397728 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m10:24:29.407827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:29.413437 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Corrected Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%d/%m/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- This line may need adjustment if the format doesn't match
        PARSE_DATETIME('%d/%m/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part
  FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m10:24:31.171456 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%d/%m/%y %H:%M'; reason: invalidQuery, location: query, message: Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%d/%m/%y %H:%M'")
[0m10:24:33.215497 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:7b5c49ed-e159-42dd-9079-60acdca253a0&page=queryresults
[0m10:24:33.218048 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 10:24:29.393894 => 10:24:33.217607
[0m10:24:33.224385 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%d/%m/%y %H:%M'
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m10:24:33.225637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b43eb9-d043-49d3-ab48-ec02fbebe852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40d8726250>]}
[0m10:24:33.226897 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 3.85s]
[0m10:24:33.228208 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m10:24:33.229684 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m10:24:33.231038 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m10:24:33.232624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m10:24:33.233845 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m10:24:33.242069 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m10:24:33.249690 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 10:24:33.234999 => 10:24:33.249300
[0m10:24:33.250804 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m10:24:33.255702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:34.061309 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m10:24:34.070187 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_product`
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m10:24:37.317815 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:832935d7-af18-495c-a818-8c19da5485e0&page=queryresults
[0m10:24:37.328659 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 10:24:33.251526 => 10:24:37.327982
[0m10:24:37.332729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b43eb9-d043-49d3-ab48-ec02fbebe852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40d87d0bd0>]}
[0m10:24:37.335683 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.10s]
[0m10:24:37.338966 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m10:24:37.342163 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m10:24:37.343272 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m10:24:37.344451 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m10:24:37.347379 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:37.348391 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m10:24:37.349406 [info ] [MainThread]: 
[0m10:24:37.351194 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 15.71 seconds (15.71s).
[0m10:24:37.353835 [debug] [MainThread]: Command end result
[0m10:24:37.374889 [info ] [MainThread]: 
[0m10:24:37.376851 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:24:37.378612 [info ] [MainThread]: 
[0m10:24:37.380503 [error] [MainThread]: [33mDatabase Error in model dim_datetime (models/transform/dim_datetime.sql)[0m
[0m10:24:37.382111 [error] [MainThread]:   Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%d/%m/%y %H:%M'
[0m10:24:37.383744 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m10:24:37.385171 [info ] [MainThread]: 
[0m10:24:37.386909 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m10:24:37.389245 [debug] [MainThread]: Command `dbt run` failed at 10:24:37.388965 after 17.09 seconds
[0m10:24:37.390666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40daf4da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40dac3a490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40dada2e10>]}
[0m10:24:37.392255 [debug] [MainThread]: Flushing usage events
[0m10:44:58.870243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a6c11110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a70bc110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a70be110>]}


============================== 10:44:58.872790 | 3c61a4fa-d65a-4c54-a941-115459afd91b ==============================
[0m10:44:58.872790 [info ] [MainThread]: Running with dbt=1.5.11
[0m10:44:58.874200 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'debug': 'False', 'quiet': 'False', 'static_parser': 'True', 'target_path': 'None', 'use_colors': 'True', 'printer_width': '80', 'no_print': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'partial_parse': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'warn_error': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m10:44:59.361654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c61a4fa-d65a-4c54-a941-115459afd91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a74d35d0>]}
[0m10:44:59.381473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c61a4fa-d65a-4c54-a941-115459afd91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a6b0f690>]}
[0m10:44:59.383085 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m10:44:59.418476 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m10:45:00.143012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:45:00.144331 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m10:45:00.180619 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m10:45:00.216084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c61a4fa-d65a-4c54-a941-115459afd91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a4c3d810>]}
[0m10:45:00.238459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c61a4fa-d65a-4c54-a941-115459afd91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a4b2f010>]}
[0m10:45:00.239591 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m10:45:00.240763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c61a4fa-d65a-4c54-a941-115459afd91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6aa12fc90>]}
[0m10:45:00.243471 [info ] [MainThread]: 
[0m10:45:00.245542 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:45:00.248182 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-dbt-bigquery'
[0m10:45:00.249546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:45:00.938013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery, now list_airflow-dbt-bigquery_retail)
[0m10:45:00.940141 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:45:01.509351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c61a4fa-d65a-4c54-a941-115459afd91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a7e48650>]}
[0m10:45:01.511093 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:45:01.512638 [info ] [MainThread]: 
[0m10:45:01.518418 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m10:45:01.520307 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m10:45:01.522592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-dbt-bigquery_retail, now model.retail.dim_customer)
[0m10:45:01.523826 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m10:45:01.553910 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m10:45:01.565610 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 10:45:01.524702 => 10:45:01.565175
[0m10:45:01.566703 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m10:45:01.584072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:02.173364 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m10:45:02.183905 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_customer`
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as customer_id,
	    Country AS country
	FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-dbt-bigquery`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m10:45:05.791882 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:c8c79b7f-bd4c-4f61-af27-949294089461&page=queryresults
[0m10:45:05.819428 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 10:45:01.567618 => 10:45:05.819160
[0m10:45:05.821694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c61a4fa-d65a-4c54-a941-115459afd91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a4c3f490>]}
[0m10:45:05.823647 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 4.30s]
[0m10:45:05.825620 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m10:45:05.826985 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m10:45:05.828096 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m10:45:05.829600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m10:45:05.830566 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m10:45:05.834404 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m10:45:05.842087 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 10:45:05.831224 => 10:45:05.841512
[0m10:45:05.843564 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m10:45:05.849208 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m10:45:05.858356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:05.863008 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    -- Since the dates are in the format "MM/DD/YYYY HH:MM", we use this format
    PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate) AS date_part
  FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m10:45:09.727439 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:8d94679f-a87e-497a-a8d3-9e62d5b24f2f&page=queryresults
[0m10:45:09.730809 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 10:45:05.844389 => 10:45:09.730568
[0m10:45:09.732344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c61a4fa-d65a-4c54-a941-115459afd91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a4c3f4d0>]}
[0m10:45:09.733549 [info ] [Thread-1 (]: 2 of 4 OK created sql table model retail.dim_datetime .......................... [[32mCREATE TABLE (23.3k rows, 8.8 MiB processed)[0m in 3.90s]
[0m10:45:09.735509 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m10:45:09.737363 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m10:45:09.738906 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m10:45:09.740866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m10:45:09.742582 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m10:45:09.750996 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m10:45:09.759537 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 10:45:09.743953 => 10:45:09.759125
[0m10:45:09.760694 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m10:45:09.765123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:10.608579 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m10:45:10.617489 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`dim_product`
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m10:45:14.128950 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:bcdc4c89-6c4f-40e8-9063-d1ae23881ecc&page=queryresults
[0m10:45:14.133744 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 10:45:09.761984 => 10:45:14.133496
[0m10:45:14.135430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c61a4fa-d65a-4c54-a941-115459afd91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a4aadb50>]}
[0m10:45:14.136727 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.40s]
[0m10:45:14.138211 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m10:45:14.140172 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m10:45:14.141117 [info ] [Thread-1 (]: 4 of 4 START sql table model retail.fct_invoices ............................... [RUN]
[0m10:45:14.142516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_product, now model.retail.fct_invoices)
[0m10:45:14.143494 [debug] [Thread-1 (]: Began compiling node model.retail.fct_invoices
[0m10:45:14.154244 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_invoices"
[0m10:45:14.161583 [debug] [Thread-1 (]: Timing info for model.retail.fct_invoices (compile): 10:45:14.144354 => 10:45:14.161161
[0m10:45:14.163015 [debug] [Thread-1 (]: Began executing node model.retail.fct_invoices
[0m10:45:14.167905 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_invoices"
[0m10:45:14.175129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:14.179750 [debug] [Thread-1 (]: On model.retail.fct_invoices: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_invoices"} */

  
    

    create or replace table `airflow-dbt-bigquery`.`retail`.`fct_invoices`
    
    

    OPTIONS()
    as (
      -- fct_invoices.sql

-- Create the fact table by joining the relevant keys from dimension table
WITH fct_invoices_cte AS (
    SELECT
        InvoiceNo AS invoice_id,
        InvoiceDate AS datetime_id,
        to_hex(md5(cast(coalesce(cast(StockCode as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as product_id,
        to_hex(md5(cast(coalesce(cast(CustomerID as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as customer_id,
        Quantity AS quantity,
        Quantity * UnitPrice AS total
    FROM `airflow-dbt-bigquery`.`retail`.`raw_invoices`
    WHERE Quantity > 0
)
SELECT
    invoice_id,
    dt.datetime_id,
    dp.product_id,
    dc.customer_id,
    quantity,
    total
FROM fct_invoices_cte fi
INNER JOIN `airflow-dbt-bigquery`.`retail`.`dim_datetime` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `airflow-dbt-bigquery`.`retail`.`dim_product` dp ON fi.product_id = dp.product_id
INNER JOIN `airflow-dbt-bigquery`.`retail`.`dim_customer` dc ON fi.customer_id = dc.customer_id
    );
  
[0m10:45:20.951850 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-dbt-bigquery&j=bq:US:798a0ac9-cc8b-43e2-bd1e-16253bf0d1bd&page=queryresults
[0m10:45:20.960464 [debug] [Thread-1 (]: Timing info for model.retail.fct_invoices (execute): 10:45:14.164363 => 10:45:20.960172
[0m10:45:20.962572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c61a4fa-d65a-4c54-a941-115459afd91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a4cb5650>]}
[0m10:45:20.964072 [info ] [Thread-1 (]: 4 of 4 OK created sql table model retail.fct_invoices .......................... [[32mCREATE TABLE (397.9k rows, 51.7 MiB processed)[0m in 6.82s]
[0m10:45:20.966130 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m10:45:20.969401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:45:20.970279 [debug] [MainThread]: Connection 'model.retail.fct_invoices' was properly closed.
[0m10:45:20.971184 [info ] [MainThread]: 
[0m10:45:20.972231 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 20.73 seconds (20.73s).
[0m10:45:20.974959 [debug] [MainThread]: Command end result
[0m10:45:21.007993 [info ] [MainThread]: 
[0m10:45:21.009697 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:45:21.011128 [info ] [MainThread]: 
[0m10:45:21.012625 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:45:21.014725 [debug] [MainThread]: Command `dbt run` succeeded at 10:45:21.014389 after 22.17 seconds
[0m10:45:21.016611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a708af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a708a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a7065cd0>]}
[0m10:45:21.018284 [debug] [MainThread]: Flushing usage events


============================== 2024-04-15 13:19:25.814126 | 5b9a0c14-607f-4eca-b762-c4ec539095be ==============================
[0m13:19:25.814126 [info ] [MainThread]: Running with dbt=1.4.9
[0m13:19:25.817706 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'profile': 'retail', 'target': 'dev', 'resource_types': [], 'output': 'json', 'select': ['path:models/transform'], 'indirect_selection': 'eager', 'which': 'list'}
[0m13:19:25.819413 [debug] [MainThread]: Tracking: tracking
[0m13:19:25.822653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f76962a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f769610d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f76960350>]}
[0m13:19:25.883785 [debug] [MainThread]: checksum: 92ac18e3946ee15d4e746c8727084f9c56105a52d4376fcc276fb9af4f10a87c, vars: {}, profile: retail, target: dev, version: 1.4.9
[0m13:19:25.921715 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m13:19:25.923730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5b9a0c14-607f-4eca-b762-c4ec539095be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f766cc490>]}
[0m13:19:28.667662 [debug] [MainThread]: 1603: static parser failed on transform/dim_customer.sql
[0m13:19:28.715960 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/dim_customer.sql
[0m13:19:28.723479 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m13:19:28.729803 [debug] [MainThread]: 1603: static parser failed on transform/dim_product.sql
[0m13:19:28.743088 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/dim_product.sql
[0m13:19:28.748212 [debug] [MainThread]: 1603: static parser failed on transform/fct_invoices.sql
[0m13:19:28.769235 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/fct_invoices.sql
[0m13:19:28.913779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b9a0c14-607f-4eca-b762-c4ec539095be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f76852690>]}
[0m13:19:28.951850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b9a0c14-607f-4eca-b762-c4ec539095be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f767c7750>]}
[0m13:19:28.953771 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m13:19:28.955347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b9a0c14-607f-4eca-b762-c4ec539095be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f76720a10>]}
[0m13:19:28.962235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f76861210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f76960350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f7d8791d0>]}
[0m13:19:28.964037 [debug] [MainThread]: Flushing usage events


============================== 2024-04-15 13:20:05.076902 | eccf7fc3-7588-47b4-865a-9ba4d2f8f603 ==============================
[0m13:20:05.076902 [info ] [MainThread]: Running with dbt=1.4.9
[0m13:20:05.080693 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'profile': 'retail', 'target': 'dev', 'resource_types': [], 'output': 'json', 'select': ['path:models/transform'], 'indirect_selection': 'eager', 'which': 'list'}
[0m13:20:05.082138 [debug] [MainThread]: Tracking: tracking
[0m13:20:05.085472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcb1f2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcb2109d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdd23b5dd0>]}
[0m13:20:05.144111 [debug] [MainThread]: checksum: 92ac18e3946ee15d4e746c8727084f9c56105a52d4376fcc276fb9af4f10a87c, vars: {}, profile: retail, target: dev, version: 1.4.9
[0m13:20:06.570895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:20:06.572646 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:20:06.581460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eccf7fc3-7588-47b4-865a-9ba4d2f8f603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdd0a47190>]}
[0m13:20:06.621294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eccf7fc3-7588-47b4-865a-9ba4d2f8f603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcb21e350>]}
[0m13:20:06.623116 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m13:20:06.624840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eccf7fc3-7588-47b4-865a-9ba4d2f8f603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcba33650>]}
[0m13:20:06.633786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcb3c8750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcb1fd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcb1fda90>]}
[0m13:20:06.635643 [debug] [MainThread]: Flushing usage events


============================== 2024-04-15 13:20:43.081956 | 8520e54f-59e1-4945-8d2c-3944424967ef ==============================
[0m13:20:43.081956 [info ] [MainThread]: Running with dbt=1.4.9
[0m13:20:43.087688 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'profile': 'retail', 'target': 'dev', 'resource_types': [], 'output': 'json', 'select': ['path:models/transform'], 'indirect_selection': 'eager', 'which': 'list'}
[0m13:20:43.089273 [debug] [MainThread]: Tracking: tracking
[0m13:20:43.092174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e5bdc8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e5bdb9f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e7e404a90>]}
[0m13:20:43.152451 [debug] [MainThread]: checksum: 92ac18e3946ee15d4e746c8727084f9c56105a52d4376fcc276fb9af4f10a87c, vars: {}, profile: retail, target: dev, version: 1.4.9
[0m13:20:44.378450 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:20:44.379494 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:20:44.387475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8520e54f-59e1-4945-8d2c-3944424967ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e60cb1190>]}
[0m13:20:44.421632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8520e54f-59e1-4945-8d2c-3944424967ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e5bc03490>]}
[0m13:20:44.423223 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m13:20:44.424773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8520e54f-59e1-4945-8d2c-3944424967ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e80901390>]}
[0m13:20:44.431575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e6142ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e5bc03490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e5bc02bd0>]}
[0m13:20:44.433231 [debug] [MainThread]: Flushing usage events


============================== 2024-04-15 13:21:21.068304 | 892fa881-b9d0-40f5-9991-5ebad00b0a83 ==============================
[0m13:21:21.068304 [info ] [MainThread]: Running with dbt=1.4.9
[0m13:21:21.072034 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'profile': 'retail', 'target': 'dev', 'resource_types': [], 'output': 'json', 'select': ['path:models/transform'], 'indirect_selection': 'eager', 'which': 'list'}
[0m13:21:21.073531 [debug] [MainThread]: Tracking: tracking
[0m13:21:21.077030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bd4bdd190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf2ea4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bd8d93610>]}
[0m13:21:21.132874 [debug] [MainThread]: checksum: 92ac18e3946ee15d4e746c8727084f9c56105a52d4376fcc276fb9af4f10a87c, vars: {}, profile: retail, target: dev, version: 1.4.9
[0m13:21:22.651050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:22.652100 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:22.661007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '892fa881-b9d0-40f5-9991-5ebad00b0a83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bd4be0a90>]}
[0m13:21:22.697185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '892fa881-b9d0-40f5-9991-5ebad00b0a83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bd4bc2ad0>]}
[0m13:21:22.699888 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m13:21:22.702358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '892fa881-b9d0-40f5-9991-5ebad00b0a83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf57c8f50>]}
[0m13:21:22.712722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bd4bc3e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bd4bc1950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bd4bc2150>]}
[0m13:21:22.715356 [debug] [MainThread]: Flushing usage events
